---
marp: true
math: mathjax
paginate: true
style: |
  section.slide-small {line-height: 1.5; }
  section.slide-small :where(p, li, blockquote, pre, code, table, th, td, figcaption) {font-size: 95%;}
  section.slide-small mjx-container,
  section.slide-small .katex {
    font-size: 0.95em;
  }

---
# 线性代数习题课 14
2025.12.30
![bg contain right:40%](./img/emoji.jpg)

---
# 半双线性型与二次型

设 $U$ 是 $\mathbb{C}^n$ 的线性子空间。函数 $f:U\times U\to\mathbb{C}$ 称为（$U$ 上的）半双线性型，如果它对第一个变量是线性的，对第二个变量是半线性的
即对任意复数 $a,b$ 和 $U$ 中的向量 $x,y,z$，有

1. $f(ax+by,z)=af(x,z)+bf(y,z)$
2. $f(x,ay+bz)=\overline{a}\,f(x,y)+\overline{b}\,f(x,z)$


设 $v_1,\cdots,v_s$ 是 $U$ 的基，则半双线性型 $f$ 在诸 $(v_i,v_j)$ 处的值完全确定了 $f$ ：

$$
f(x,y)=\sum_{i,j=1}^{s} f_{ij}\,x_i\,\bar{y}_j,\quad
f_{ij}=f(v_i,v_j).
$$

其中 $x=\sum_{i=1}^{s} x_i v_i,\quad y=\sum_{j=1}^{s} y_j v_j.$

矩阵 $F=(f_{ij})$ 称为 $f$ 在基 $(v_i)$ 下的矩阵

---
# 半双线性型与二次型


如果从基 $v_1,\cdots,v_s$ 到另一个基 $v_1',\cdots,v_s'$ 的转换矩阵是 $A$，那么 $f$ 在基 $(v_i')$ 下的矩阵为

$$
F'= A^TF\bar{A}
$$

称半双线性型 $f$ 是埃尔米特型，如果 $f(x,y)=\overline{f(y,x)}$，等价于它的矩阵 $F=(f_{ij})$ 满足条件 $F^*=F$，即 $F$ 是埃尔米特矩阵

称半双线性型 $f$ 是斜埃尔米特型，如果 $f(x,y)=-\overline{f(y,x)}$，等价于它的矩阵 $F=(f_{ij})$ 满足 $F^*=-F$，即 $F$ 为斜埃尔米特矩阵

每个埃尔米特型 $f$ 确定了一个埃尔米特二次型 $q(x)=f(x,x)$，这是 $U$ 上的实值函数

---
# 半双线性型与二次型
如果埃尔米特型 $f$ 在某个基下的矩阵是对角的，那么 $f$ 和它给出的二次型就有如下整齐简洁的形式：
$$
f(x,y)=f_1x_1\overline{y_1}+\cdots+f_sx_s\overline{y_s}, \qquad 
$$
$$
q(x)=f_1|x_1|^2+\cdots+f_s|x_s|^2
$$

上面两式分别称为埃尔米特型 $f$ 和埃尔米特二次型 $q$ 的一个典范式，相应的基称为 $f$ 和 $q$ 的典范基

称埃尔米特二次型 $q(x)$ 是正定的：若对任意非零的 $x\in U$ 有 $q(x)>0$ . 如果 $q(x)$ 是正定的，我们也称 $q(x)$（或相应的埃尔米特型）在任何基下的矩阵是正定的

---
# 半双线性型与二次型
定理：设 $U$ 是 $\mathbb{C}^n$ 的线性子空间，$f$ 是 $U$ 上的埃尔米特型。那么 $f$ 有典范标准正交基。特别地，向量空间 $\mathbb{C}^n$ 上的每个埃尔米特型 $f$ 都有典范标准正交基

推论：设 $U$ 是 $\mathbb{C}^n$ 的线性子空间，$q$ 是 $U$ 上的埃尔米特二次型，秩为 $r$ . 那么存在 $U$ 的标准正交基使得 $q$ 有如下的典范式：
$$
q(x)=\lambda_1|x_1|^2+\cdots+\lambda_r|x_r|^2,
$$
其中 $x_1,x_2,\cdots,x_s$ 是 $x$ 在这个标准正交基下的坐标，$\lambda_1,\lambda_2,\cdots,\lambda_r$ 是 $q(x)$ 在这个标准正交基的前 $r$ 个向量的值，也是 $q$ 在任何一个标准正交基下的矩阵的非零特征值

特别地，$q(x)$ 是正定的（或半正定的）当且仅当 $q(x)$ 在一个标准正交基下的矩阵的特征值都是正的（或非负的）

---
# 半双线性型与二次型
推论（主轴定理）：设 $q(x)=\sum_{i,j=1}^{n} a_{ij}x_i\overline{x_j}$ 是复二次函数，且 $a_{ij}=\overline{a_{ji}}$ . 那么存在 $n$ 阶酉矩阵 $T$ 使得做变量替换 $x=Ty$ 后有
$$
q(x)=\lambda_1|y_1|^2+\lambda_2|y_2|^2+\cdots+\lambda_r|y_r|^2.
$$
这里 $\lambda_1,\lambda_2,\cdots,\lambda_r$ 是 $n$ 阶方阵 $(a_{ij})$ 的非零特征值

设 $A$ 是 $n$ 阶埃尔米特矩阵，那么下面条件等价：

1. $A$ 是正定的；
2. $A$ 的特征值都是正的；
3. 存在可逆矩阵 $P$（$n$ 阶方阵）使得 $A=P^*P$

---
# 酉算子
复内积空间 $V$ 上的线性算子 $\mathcal A$ 如果保持内积不变，即

$$
(\mathcal A\alpha, \mathcal A\beta) = (\alpha, \beta), \quad \forall\,\alpha,\beta \in V,
$$

那么称 $\mathcal A$ 是 $V$ 上的一个酉变换


$n$ 维酉空间 $V$ 上的线性变换 $\mathcal A$ 是酉变换

$$
\Longleftrightarrow A\ \text{在}\ V\ \text{的标准正交基下的矩阵是酉矩阵}
$$

$$
\Longleftrightarrow A\ \text{把}\ V\ \text{的标准正交基映成标准正交基}
$$

酉算子的不变子空间的正交补依然是不变子空间

---
# 酉矩阵
### 酉矩阵的性质
1. 特征值的模长都为 $1$
2. 行列式的模长为 $1$
3. 不同特征值对应的特征向量正交
4. 酉矩阵的逆，乘积，共轭转置依然是酉矩阵
5. 可被酉对角化

**定理**：设 $A$ 是 $n$ 阶酉矩阵，那么存在 $n$ 阶酉矩阵 $B$ 使得 $B^{-1}AB$ 为对角矩阵，而且对角线上的数的模都是 $1$

酉矩阵的酉对角化步骤跟埃尔米特矩阵的酉对角化完全相同

---
# 约当标准形
设 $\lambda$ 是复数，如下形式的 $n$ 阶方阵 $J_n(\lambda)$ 称为以 $\lambda$ 为特征值的 $n$ 阶约当块：

$$
J_n(\lambda)=
\begin{pmatrix}
\lambda & 1 & 0 & \cdots & 0 & 0\\
0 & \lambda & 1 & \cdots & 0 & 0\\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots\\
0 & 0 & 0 & \cdots & \lambda & 1\\
0 & 0 & 0 & \cdots & 0 & \lambda
\end{pmatrix}
$$

---
# 约当标准形
约当矩阵就是一个分块对角矩阵：

$$
\begin{pmatrix}
J_{m_1}(\lambda_1) & 0 & \cdots & 0\\
0 & J_{m_2}(\lambda_2) & \cdots & 0\\
\vdots & \vdots & \ddots & \vdots\\
0 & 0 & \cdots & J_{m_s}(\lambda_s)
\end{pmatrix}
$$

**定理**：设 $A$ 是 $n$ 阶复方阵，那么 $A$ 有约当标准形，即存在 $n$ 阶复可逆方阵 $C$ 使得 $C^{-1}AC = J(A)$ 是约当矩阵。若不计约当块之间的置换，$A$ 的约当标准形是唯一的

> 两个复矩阵相似，当且仅当它们具有相同的约当标准形，允许对约当块的排列顺序进行置换

---
# 约当标准形-求约当标准形
> 建议看看教材和丘老高代上的一些例子
1. 首先求出 $A$ 的特征多项式，并把它分解成一次多项式的乘积：
$$
\chi_A(t)=\prod_{i=1}^{p}(t-\lambda_i)^{n_i}.
$$

2. 对每一个特征值 $\lambda$，求出 $A-\lambda E$ 的秩。  
那么 $J(A)$ 中以 $\lambda$ 为特征值的约当块的个数是

$$
N(\lambda)=n-\operatorname{rk}(A-\lambda E).
$$

设 $m$ 是 $\lambda$ 的代数重数（即当 $\lambda=\lambda_i$ 时 $m=n_i$），则 $m$ 是 $\lambda$ 出现在 $J(A)$ 的对角线上的次数，它等于以 $\lambda$ 为特征值的约当块的阶数的和。

---
# 约当标准形-求约当标准形
3. 要求出 $k$ 阶约当块 $J_k(\lambda)$ 在 $J(A)$ 中出现的次数 $N(\lambda,k)$，应用公式：

$$
N(\lambda,k)
=\operatorname{rank}(A-\lambda E)^{k-1}
-2\operatorname{rank}(A-\lambda E)^{k}
+\operatorname{rank}(A-\lambda E)^{k+1}.
$$

在 $k\ge m$ 时，有 $\operatorname{rank}(A-\lambda E)^k=n-m.$（若 $\lambda=\lambda_i$，则 $m=n_i$）

通过上面三个步骤，就可以求出约当标准形 $J(A)$ . 如果要求出矩阵 $C$ 使得 $C^{-1}AC=J(A)$，还需要求出算子 $\mathcal A:\mathbb{C}^n\to\mathbb{C}^n,\ X\mapsto AX$ 的约当基。

---
# 约当标准形-求约当基
4. 对特征值 $\lambda$，有广义特征空间

$$
V(\lambda)=\{X\in\mathbb{C}^n\mid (A-\lambda E)^mX=0\}
$$

广义特征空间是 $\mathcal A$ 的不变子空间，贡献所有以 $\lambda$ 为特征值的约当块，并且也只贡献以 $\lambda$ 为特征值的约当块。这里 $m=n_i$ 如果 $\lambda=\lambda_i$.

如果 $p$ 是以 $\lambda$ 为特征值的约当块的最大阶数，那么有

$$
V(\lambda)=\{X\in\mathbb{C}^n\mid (A-\lambda E)^pX=0\}.
$$

---
# 约当标准形-求约当基
5. 取 $V(\lambda)$ 的一个基 $X_1,\cdots,X_m$，在 $(A-\lambda E)^{p-1}X_1,\cdots,(A-\lambda E)^{p-1}X_m$ 中取一个极大线性无关组，设为 $(A-\lambda E)^{p-1}e_1,\ \cdots,\ (A-\lambda E)^{p-1}e_{s_p}$，这里的诸 $e_i$ 都是向量组 $X_1,\cdots,X_m$ 中的元素。

线性无关向量组 $(A-\lambda E)^{p-1}e_1,\cdots,(A-\lambda E)^{p-1}e_{s_p}$ 是 
$$
V(\lambda)_p=(\mathcal A-\lambda E)^{p-1}V(\lambda)\cap\ker(\mathcal A-\lambda E)
$$

的基。

对 $e_1,\cdots,e_{s_p}$ 中每一个元素 $e_i$，通过 $\mathcal A-\lambda \mathcal E$ 及其幂的作用得到向量组

$$
(\mathcal A-\lambda \mathcal E)^{p-1}e_i,\ (\mathcal A-\lambda \mathcal E)^{p-2}e_i,\ \cdots,\ (\mathcal A-\lambda \mathcal E)e_i,\ e_i.
$$

这些向量张成 $\mathcal A$ 的一个不变子空间，给出一个 $p$ 阶的以 $\lambda$ 为特征值的约当块。

---
# 约当标准形-求约当基
接下来在 $V(\lambda)$ 中取线性无关的向量 $e_{s_p+1},e_{s_p+2},\cdots,e_{s_{p-1}}$，使得向量组 $(\mathcal A-\lambda \mathcal E)^{p-1}e_1,\cdots,(\mathcal A-\lambda \mathcal E)^{p-1}e_{s_p},\ (\mathcal A-\lambda \mathcal E)^{p-2}e_{s_p+1},\cdots,(\mathcal A-\lambda \mathcal E)^{p-2}e_{s_{p-1}}$

是 $V(\lambda)_{p-1}=(\mathcal A-\lambda \mathcal E)^{p-2}V(\lambda)\cap\ker(\mathcal A-\lambda \mathcal E)$ 的基。如此下去，最后得到向量组

$$
e_1,\cdots,e_{s_p},\ e_{s_p+1},\cdots,e_{s_{p-1}},\ \cdots,\ e_{s_2+1},\cdots,e_{s_1}.
$$

使得对于不超过 $p$ 的正整数 $k$，向量组

$$
(\mathcal A-\lambda \mathcal E)^{p-1}e_1,\cdots,(\mathcal A-\lambda \mathcal E)^{p-1}e_{s_p},\ \cdots,\
(\mathcal A-\lambda \mathcal E)^{k-1}e_{s_{k+1}+1},\cdots,(\mathcal A-\lambda \mathcal E)^{k-1}e_{s_k}
$$

是 $V(\lambda)_k=(\mathcal A-\lambda \mathcal E)^{k-1}V(\lambda)\cap\ker(\mathcal A-\lambda \mathcal E)$ 的基。

---
# 约当标准形-求约当基
对 $e_{s_{k+1}+1},\cdots,e_{s_k}$ 中的每一个向量 $e_j$，由 $\mathcal A-\lambda \mathcal E$ 及其幂的作用得到向量组

$$
(\mathcal A-\lambda \mathcal E)^{k-1}e_j,\ (\mathcal A-\lambda \mathcal E)^{k-2}e_j,\ \cdots,\ (\mathcal A-\lambda \mathcal E)e_j,\ e_j,
$$

这些向量张成 $\mathcal A$ 的一个不变子空间，给出一个 $k$ 阶的以 $\lambda$ 为特征值的约当块，如此一来得到了约当基中贡献所有 $s_k-s_{k+1}$ 个 $J_k(\lambda)$ 的那一部分基向量。

这样就得到了约当基中给出以 $\lambda$ 为特征值的约当块的那一部分基向量。把每一个特征值对应的这些向量合起来，就得到 $\mathcal A$ 的一个约当基。以这个基的向量为列向量得到一个矩阵 $C$，就有 $CAC^{-1}=J(A).$

> **可以通过解矩阵方程 $AP=PJ$ 来求解约当基（并非不太可行）！！！**

---
# 。