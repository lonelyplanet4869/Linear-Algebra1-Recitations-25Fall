---
marp: true
math: mathjax
paginate: true
style: |
  section.slide-small {line-height: 1.5; }
  section.slide-small :where(p, li, blockquote, pre, code, table, th, td, figcaption) {font-size: 95%;}
  section.slide-small mjx-container,
  section.slide-small .katex {
    font-size: 0.95em;
  }
---
# 线性代数习题课 11
2025.12.9
![bg contain right:40%](./img/emoji.jpg)

---
# 相似不变量
相似的矩阵具有相同的特征多项式和特征值（包括代数重数与几何重数），还有相同的秩、行列式、零空间维数、迹等不变量，但**不一定有相同的特征子空间或特征向量**

> 如果两个矩阵的特征值相同，且不同特征值对应的特征向量/特征子空间相同，那么这两个矩阵相似吗？

> 如果加上两个矩阵都可对角化的条件呢？

---
# 相似不变量
$n$ 阶矩阵 $A=(a_{ij})$ 的主对角线上的元素之和称为 $A$ 的**迹**，记作 $\mathrm{tr}(A)$，即

$$
\mathrm{tr}(A)=a_{11}+a_{22}+\cdots+a_{nn}
$$

矩阵的迹具有下列性质：
1. $\mathrm{tr}(A+B)=\mathrm{tr}(A)+\mathrm{tr}(B)$

2. $\mathrm{tr}(\lambda A)=\lambda\,\mathrm{tr}(A)$

3. $\mathrm{tr}(A^{T}) = \mathrm{tr}(A)$

4. $\mathrm{tr}(AB)=\mathrm{tr}(BA)$

---
# 两个小结论
设 $\lambda_1,\cdots,\lambda_n$ 是 $\mathbb{R}$ 上的方阵 $A$ /线性算子 $\mathcal A$ 的全部（复）特征值（重数计入），则有  
$$
\operatorname{tr} A = \sum_{i=1}^n \lambda_i
\quad
\det A = \prod_{i=1}^n \lambda_i
$$

设 $A$ 是 $\mathbb{R}$ 上的 $n$ 阶矩阵，则 $A$ 的特征多项式 $|\lambda I-A|$ 是一个 $n$ 次多项式，$\lambda^n$ 的系数是 $1$，$\lambda^{n-1}$ 的系数等于 $-\mathrm{tr}(A)$，常数项为 $(-1)^n|A|$，$\lambda^{n-k}$ 的系数为 $A$ 的所有 $k$ 阶主子式的和乘以 $(-1)^k$，$1\le k<n$

---
# 两个重数
设 $A$ 是 $\mathbb{R}$ 上的 $n$ 阶矩阵，$\lambda_{1}$ 是 $A$ 的一个特征值。把 $A$ 的属于 $\lambda_{1}$ 的特征子空间的维数叫作特征值 $\lambda_{1}$ 的**几何重数**，而把 $\lambda_{1}$ 作为 $A$ 的特征多项式的根的重数叫作 $\lambda_{1}$ 的**代数重数**，有时把代数重数简称为重数

设 $\lambda_{1}$ 是 $\mathbb{R}$ 上的 $n$ 阶矩阵 $A$ 的一个特征值，则 $\lambda_{1}$ 的几何重数不超过它的代数重数

$\mathbb R$ 上的 $n$ 阶矩阵 $A$ 在实数上可对角化的充要条件是：$A$ 的特征多项式的全部复根都是实根，并且 $A$ 的每个特征值的几何重数等于它的代数重数

---
# 不变子空间
设 $\mathcal A$ 是线性空间 $U$ 上的线性算子。$U$ 的线性子空间 $V$ 称为 $\mathcal A$ 的不变子空间，如果对于 $V$ 中的任意向量 $v$，都有 $\mathcal Av\in V$ . 记 $\mathcal{A}V=\{\mathcal{A}x\mid x\in V\}$，则 $V$ 是线性算子 $\mathcal A$ 的不变子空间的含义是 $\mathcal AV\subset V$

线性算子 $\mathcal A$ 的像 $\operatorname{im}\mathcal A$、核 $\ker \mathcal A$ 与特征子空间都是 $\mathcal A$ 的不变子空间

线性算子 $\mathcal A$ 的不变子空间的和与交仍是 $\mathcal A$ 的不变子空间

设 $\mathcal{A}$ 是线性空间 $U$ 上的线性算子，$V = \langle \alpha_{1}, \alpha_{2}, \cdots, \alpha_{s} \rangle$ 是 $U$ 的一个子空间，则 $V$ 是 $\mathcal{A}$ 的不变子空间当且仅当 $\mathcal{A}\alpha_{i} \in W,\ i = 1, 2, \cdots, s$

设 $\mathcal{A}$ 是线性空间 $U$ 上的线性算子，$\xi \in U$ 且 $\xi \ne 0$，则 $\langle \xi \rangle$ 是 $\mathcal{A}$ 的不变子空间当且仅当 $\xi$ 是 $\mathcal{A}$ 的一个特征向量

---
# 不变子空间
设 $\mathcal{A}$ 是 $n$ 维线性空间 $V$ 上的一个线性算子，$W$ 是 $\mathcal{A}$ 的一个非平凡的不变子空间，  
在 $W$ 中取一个基 $\alpha_1,\cdots,\alpha_r$，把它扩充成 $V$ 的一个基 $\alpha_1,\cdots,\alpha_r,\alpha_{r+1},\cdots,\alpha_n$，则 $\mathcal{A}$ 在此基下的矩阵 $A$ 为一个分块上三角矩阵 
$$
A=
\begin{pmatrix}
A_1 & A_3 \\
0   & A_2
\end{pmatrix},
$$ 
其中 $A_1$ 是 $\mathcal{A}\rvert_W$ 在 $W$ 的一个基 $\alpha_1,\cdots,\alpha_r$ 下的矩阵

反之，如果 $\mathcal{A}$ 在 $V$ 的一个基 $\alpha_1,\cdots,\alpha_r,\alpha_{r+1},\cdots,\alpha_n$ 下的矩阵 $A$ 为分块上三角矩阵 
$$
A=
\begin{pmatrix}
A_1 & A_3 \\
0   & A_2
\end{pmatrix},
$$ 
令 $W=\langle \alpha_1,\cdots,\alpha_r\rangle$，那么 $W$ 是 $\mathcal{A}$ 的一个非平凡不变子空间，且 $\mathcal{A}\rvert_W$ 在 $W$ 的一个基 $\alpha_1,\cdots,\alpha_r$ 下的矩阵是 $A_1$


---
# 不变子空间
1. 线性算子 $\mathcal A:\mathbb{R}^n \to \mathbb{R}^n$ 在某个基下的矩阵具有二阶分块对角的形式当且仅当 $\mathbb{R}^n$ 是两个 $\mathcal A$ 的不变子空间 $V$ 和 $W$ 的直和

2. 更一般地，设 $\mathcal{A}$ 是 $\mathbb{R}^n$ 上的一个线性算子，则 $\mathcal{A}$ 在 $\mathbb{R}^n$ 的一个基下的矩阵为分块对角矩阵：
$$
\begin{pmatrix}
A_1 & 0   & \cdots & 0 \\
0   & A_2 & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0   & 0   & \cdots & A_s
\end{pmatrix}
$$
当且仅当 $\mathbb{R}^n$ 能分解成 $\mathcal{A}$ 的非平凡不变子空间的直和：$\mathbb{R}^n = W_1 \oplus W_2 \oplus \cdots \oplus W_s$，并且 $A_i$ 是 $\mathcal{A}\rvert_{W_i}$ 在 $W_i$ 的一个基下的矩阵

---
# 不变子空间与特征多项式的分解
**（定理5.31）** 设 $\mathbb{R}^n$ 的子空间 $V$ 是 $\mathbb{R}^n$ 上的线性算子 $\mathcal A$ 的不变子空间。假设 $\mathcal A$ 在 $V$ 的某个基下的矩阵是 $A_1$，那么方阵 $A_1$ 的特征多项式 $\chi_{A_1}(t)$ 整除 $A$ 的特征多项式 $\chi_A(t)$（如果算子 $\mathcal A$ 有非平凡的不变子空间，那么该算子的特征多项式可以分解成两个正次数的多项式的乘积）

推论：如果 $\mathbb{R}^n$ 上的线性算子可对角化，即 $\mathbb{R}^n = \bigoplus_{i=1}^m \mathbb{R}_{\lambda_i}^n$，其中 $\lambda_1,\dots,\lambda_m$ 互不相同且 $\mathbb{R}_{\lambda_i}^n$ 是特征值 $\lambda_i$ 的特征子空间，$W \subset \mathbb{R}^n$ 是该线性算子的一个不变子空间，那么 $W = \bigoplus_{i=1}^m \bigl(W \cap \mathbb{R}_{\lambda_i}^n\bigr)$

**（定理5.32）** 设 $\mathbb{R}^n$ 是线性算子 $\mathcal A$ 的不变子空间 $V_1,\dots,V_k$ 的直和，$A_i$ 为 $\mathcal A$ 在 $V_i$ 的某个基下的矩阵。那么
$$
\chi_A(t)=\chi_{A_1}(t)\,\chi_{A_2}(t)\cdots\chi_{A_k}(t)
$$

---
# 不变子空间与特征多项式的分解
**（定理5.35）**$\mathbb{R}^n$ 上的线性算子一定有一维或二维的不变子空间

**（定理5.36）** 如果 $\mathbb{R}^n$ 上的线性算子 $\mathcal A$ 的特征多项式能分解成两个正次数的实系数多项式的乘积，那么 $\mathcal A$ 有非平凡的不变子空间

**（定理5.37）** 设 $\mathbb{R}^n$ 上的线性算子 $\mathcal A$ 的特征多项式 $\chi_\mathcal A(t)$ 是两个互素（即最大公因式为 $1$）的多项式 $\xi(t)$ 和 $\eta(t)$ 的乘积。定义

$$
U = \{u \in \mathbb{R}^n \mid \xi(\mathcal A)u = 0\}, \quad
V = \{v \in \mathbb{R}^n \mid \eta(\mathcal A)v = 0\}.
$$

那么：

1. $U$ 和 $V$ 都是 $\mathcal A$ 的不变子空间，而且 $\mathbb{R}^n$ 是 $U$ 和 $V$ 的直和
2. $\xi(\mathcal A)$ 在 $V$ 上的限制是可逆的，$\eta(\mathcal A)$ 在 $U$ 上的限制是可逆的

---
# 不变子空间与特征多项式的分解
（定理5.37推广）设 $\mathcal{A}$ 的特征多项式 $f(\lambda)$ 在 $F[\lambda]$ 中分解成
$$
f(\lambda)=p_1^{\,r_1}(\lambda)p_2^{\,r_2}(\lambda)\cdots p_s^{\,r_s}(\lambda), 
$$
其中 $p_1(\lambda),p_2(\lambda),\dots,p_s(\lambda)$ 是 $F$ 上两两不等的首一不可约多项式，$r_i>0,\ i=1,2,\dots,s$，则
$$
V=\ker\bigl(p_1^{\,r_1}(\mathcal{A})\bigr)\oplus
  \ker\bigl(p_2^{\,r_2}(\mathcal{A})\bigr)\oplus\cdots\oplus
  \ker\bigl(p_s^{\,r_s}(\mathcal{A})\bigr)
$$


特别地，如果 $f(\lambda)$ 在 $F[\lambda]$ 中能分解成
$$
f(\lambda)=(\lambda-\lambda_1)^{r_1}(\lambda-\lambda_2)^{r_2}\cdots(\lambda-\lambda_s)^{r_s},
$$
其中 $\lambda_1,\lambda_2,\dots,\lambda_s$ 是 $F$ 中两两不等的元素，$r_i>0,\ i=1,2,\dots,s$，则
$$
V=\ker\bigl((\mathcal{A}-\lambda_1 I)^{r_1}\bigr)\oplus
  \ker\bigl((\mathcal{A}-\lambda_2 I)^{r_2}\bigr)\oplus\cdots\oplus
  \ker\bigl((\mathcal{A}-\lambda_s I)^{r_s}\bigr) 
$$
且 $\ker\bigl((\mathcal{A}-\lambda_i I)^{r_i}\bigr)$ 的维数等于 $r_i$

---
# 凯莱-哈密顿定理
$\mathbb{R}^n$ 上的线性算子 $\mathcal A$ 的特征多项式在 $\mathcal A$ 处的取值为

$$
\chi_\mathcal A(\mathcal A)=\mathcal A^n+\chi_1\mathcal A^{n-1}+\cdots+\chi_{n-1}\mathcal A+\chi_n\mathcal E
$$

定理：线性算子 $\chi_\mathcal A(\mathcal A)$ 是零算子，即对于 $\mathbb{R}^n$ 中任意向量 $v$，有 $\chi_\mathcal A(\mathcal A)v=\mathcal Ov=0$

推论：设 $A$ 是 $n$ 阶方阵，它的特征多项式是  
$\chi_A(t)=t^n+\chi_1 t^{n-1}+\cdots+\chi_{n-1}t+\chi_n$，那么 $\chi_A(A)=0$，即

$$
\chi_A(A)=A^n+\chi_1A^{n-1}+\cdots+\chi_{n-1}A+\chi_nE=0
$$

线性算子 $\mathcal A$ 的特征多项式零化该线性算子
方阵 $A$ 的特征多项式零化该方阵

---
# 极小多项式
在零化线性算子 $\mathcal A$ 的非零多项式中次数最小的，首项（即最高次项）系数为 $1$ 的那个称为 $\mathcal A$ 的**极小多项式**（方阵同理）

> 极小多项式的存在性与唯一性感兴趣的同学自行了解

$\mathcal A$ 的极小多项式 $\mu_\mathcal A(t)$ 是 $\mathcal A$ 的特征多项式 $\chi_\mathcal A(t)$（也是 $\mathcal A$ 的任何零化多项式）的因子

线性算子/方阵的极小多项式和其特征多项式有相同的根（不记重数），也就是说线性算子/方阵的的极小多项式的零点即为特征值（在更大的域上依然成立）

相似的矩阵具有相同的极小多项式

线性算子/方阵可对角化的充要条件是其极小多项式在 $F[\lambda]$ 中能分解成不同的一次因式的乘积

---
# 极小多项式
<!-- _class: slide-small -->
设 $\mathcal A$ 是线性空间 $V$ 上的线性算子，如果 $V$ 能分解成 $\mathcal A$ 的一些非平凡不变子空间的直和：
$$
V = W_1 \oplus W_2 \oplus \cdots \oplus W_s, 
$$
那么 $\mathcal A$ 的极小多项式 $m(\lambda)$ 为
$$
m(\lambda) = [m_1(\lambda), m_2(\lambda), \cdots, m_s(\lambda)], 
$$
其中 $m_j(\lambda)$ 是 $W_j$ 上的线性变换 $\mathcal A|_{W_j}$ 的最小多项式，$j=1,2,\cdots,s$；$[m_1(\lambda), m_2(\lambda), \cdots, m_s(\lambda)]$ 是 $m_1(\lambda), m_2(\lambda), \cdots, m_s(\lambda)$ 的最小公倍式

设 $A$ 是一个 $n$ 阶分块对角矩阵，即
$$
A = \operatorname{diag}\{A_1, A_2, \cdots, A_s\},
$$
设 $A_j$ 的极小多项式是 $m_j(\lambda)$，$j=1,2,\cdots,s$，则 $A$ 的极小多项式 $m(\lambda)$ 为
$$
m(\lambda) = [m_1(\lambda), m_2(\lambda), \cdots, m_s(\lambda)]
$$

---
# 极小多项式
1. 求下列 $\mathbb R$ 上的方阵的极小多项式，并判断它们是否可对角化

$$
A=
\begin{pmatrix}
3 & 1 & -1 \\
0 & 2 & 0 \\
1 & 1 & 1
\end{pmatrix},\quad
B=
\begin{pmatrix}
1 & 1 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{pmatrix},\quad
C=
\begin{pmatrix}
7  & -1 & -7 & 1  \\
-1 & 7  & 1  & -7 \\
7  & -1 & -7 & 1  \\
-1 & 7  & 1  & -7
\end{pmatrix}
$$

---
# 极小多项式
2. 求下列 $\mathbb R$ 上的方阵 $A$ 和 $B$ 的极小多项式，并判断 $A$ 与 $B$ 是否相似

$$
A=
\begin{pmatrix}
3 & 1 & 0 & 0 \\
0 & 3 & 0 & 0 \\
0 & 0 & 5 & 0 \\
0 & 0 & 0 & 5
\end{pmatrix},
\quad
B=
\begin{pmatrix}
3 & 1 & 0 & 0 \\
0 & 3 & 0 & 0 \\
0 & 0 & 3 & 0 \\
0 & 0 & 0 & 5
\end{pmatrix}
$$

3. 设 $\mathbb R$ 上的 $n$ 阶矩阵 $A$ 满足 $A^3 = 3A^2 + A - 3I$，判断 $A$ 是否可对角化

---
# 凯莱-哈密顿定理

1. 设 $\mathcal A$ 是 $\mathbb{R}^n$ 上的线性算子，特征多项式为  
   $$
   \chi_\mathcal A(t)=t^n+\chi_1 t^{n-1}+\cdots+\chi_{n-1}t+\chi_n
   $$
   那么 $\mathcal A$ 可逆当且仅当特征多项式的常数项 $\chi_n\neq 0$ . 这时候
   $$
   \mathcal A^{-1}=-\chi_n^{-1}\bigl(\mathcal A^{n-1}+\chi_1\mathcal A^{n-2}+\cdots+\chi_{n-1}\mathcal E\bigr)
   $$

2. 设 $A$ 是 $n$ 阶方阵，特征多项式为  
   $$
   \chi_A(t)=t^n+\chi_1 t^{n-1}+\cdots+\chi_{n-1}t+\chi_n.
   $$
   那么 $A$ 可逆当且仅当特征多项式的常数项 $\chi_n\neq 0$ . 这时候
   $$
   A^{-1}=-\chi_n^{-1}\bigl(A^{n-1}+\chi_1A^{n-2}+\cdots+\chi_{n-1}E\bigr)
   $$

---
# 凯莱-哈密顿定理
设 $A$ 是方阵，$f(t)$ 是多项式。带余除法给出
$$
f(t)=q(t)\chi_A(t)+r(t),
$$
其中 $r(t)$ 的次数小于 $\chi_A(t)$ 的次数。根据凯莱–哈密顿定理，$\chi_A(A)=0$，于是（约定：$A^0=E$ 是单位矩阵）
$$
f(A)=r(A).
$$
余项 $r(t)$ 可以用待定系数法确定。如果 $\lambda$ 是 $A$ 的特征多项式 $\chi_A(t)$ 的根，那么
$$
f(\lambda)=q(\lambda)\chi_A(\lambda)+r(\lambda)=q(\lambda)\cdot 0+r(\lambda)=r(\lambda)
$$
如果 $\lambda$ 是 $\chi_A(t)$ 的 $k$ 重根，那么，对 $i=0,1,\ldots,k-1$，多项式 $f$ 的 $i$ 阶导数在 $\lambda$ 处的值为（约定 $f^{(0)}=f$）
$$
f^{(i)}(\lambda)=r^{(i)}(\lambda)
$$

---
# 对角化
线性算子/方阵（在实数域上）可对角化的充要条件有：
1. 有 $n$ 个线性无关的特征向量
2. $\mathbb R^n$ 中存在由其特征向量构成的一个基
3. 属于不同特征值的特征子空间维数之和为 $n$
4. $\mathbb{R}^n$ 是属于不同特征值的所有特征子空间的和/直和
5. 特征多项式的全部复根都是实根，并且每个特征值的几何重数等于它的代数重数
6. 极小多项式在实数域上能分解成不同的一次因式的乘积

---
# 习题
1. 设 $\mathcal A$ 与 $\mathcal B$ 都是 $V$ 上的线性算子，如果 $\mathcal A$ 与 $\mathcal B$ 可交换，那么 $\ker \mathcal B,~\operatorname{Im} \mathcal B,~\mathcal B$ 的特征子空间都是 $\mathcal A$ 的不变子空间
2. 设 $V$ 是复数域上的 $n$ 维线性空间，$\mathcal A,\mathcal B$ 都是 $V$ 上的线性算子。证明：如果 $\mathcal A$ 与 $\mathcal B$ 可交换，那么 $\mathcal A$ 与 $\mathcal B$ 至少有一个公共的特征向量

---
# 习题
3. 设 $V$ 是复数域上的 $n$ 维线性空间，$\mathcal A,\mathcal B$ 都是 $V$ 上的线性变换，且 $\mathcal A$ 有 $s$ 个不同的特征值。证明：如果 $\mathcal A$ 与 $\mathcal B$ 可交换，那么 $\mathcal A$ 与 $\mathcal B$ 至少有 $s$ 个公共的特征向量，并且它们线性无关
4. 设 $A,B$ 都是 $n$ 阶复矩阵。证明：如果 $A$ 与 $B$ 可交换，那么存在 $n$ 阶可逆复矩阵 $P$，使得 $P^{-1}AP~\text{和}~P^{-1}BP$ 都是上三角矩阵

---
# 习题
<!-- _class: slide-small -->
设 $V$ 是 $n$ 维线性空间，$V$ 上的线性算子 $\mathcal A$ 在 $V$ 的一个基 $\alpha_1,\alpha_2,\cdots,\alpha_n$ 下的矩阵为  

$$
A=
\begin{pmatrix}
a & 1 & 0 & \cdots & 0 & 0 \\
0 & a & 1 & \cdots & 0 & 0 \\
0 & 0 & a & \cdots & 0 & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \cdots & a & 1 \\
0 & 0 & 0 & \cdots & 0 & a
\end{pmatrix}.
$$

1. 证明：若 $\mathcal A$ 的一个不变子空间 $W$ 有向量 $\alpha_n$，则 $W = V$；  
2. 证明：$\alpha_1$ 属于 $\mathcal A$ 的任意一个非零不变子空间；  
3. 证明：$V$ 不能分解成 $\mathcal A$ 的两个非平凡不变子空间的直和；  
4. 求 $\mathcal A$ 的所有不变子空间
